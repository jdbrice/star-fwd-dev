cd /tmp/star-build


full_build=${1:-0}

if [ $full_build -eq 1 ]; then
    echo "Running CMAKE before build (needed first time)"

STAR_PATCH=""
STAR_BUILD_TYPE=Release
cmake /tmp/star-sw -DSTAR_SRC=/tmp/star-cvs \
    -DSTAR_PATCH=${STAR_PATCH} -DCMAKE_INSTALL_PREFIX=/tmp/star-install \
    -DCERNLIB_ROOT=/cern/2006 -DCMAKE_BUILD_TYPE=${STAR_BUILD_TYPE}
fi


# Build + Install StgMaker Fast
make StgMaker/fast -j2 && cp /tmp/star-build/StRoot/StgMaker/libStgMaker.so /tmp/star-install/lib/libStgMaker.so

# Build + install StSiSimulatorMaker Fast
make StSiSimulatorMaker/fast -j2 && cp /tmp/star-build/StRoot/StSiSimulatorMaker/libStSiSimulatorMaker.so /tmp/star-install/lib/libStSiSimulatorMaker.so

make StSiSlowSimulatorMaker/fast -j2 && cp /tmp/star-build/StRoot/StSiSlowSimulatorMaker/libStSiSlowSimulatorMaker.so /tmp/star-install/lib/libStSiSlowSimulatorMaker.so

# make StFstFitter/fast -j2 && cp /tmp/star-build/StRoot/StFstFitter/libStFstFitter.so /tmp/star-install/lib/libStSiSimulatorMaker.so


cd /tmp/work
